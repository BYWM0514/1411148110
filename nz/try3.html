<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>我要成功</title>
  <script src="https://cdn.jsdelivr.net/npm/aframe@1.4.2/dist/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
  <style>
    body, html {
      margin: 0; padding: 0; overflow: hidden; height: 100%;
      background: #000;
    }
    .buttons {
      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 10;
    }
    button {
      padding: 10px 20px;
      margin: 0 10px;
      font-size: 16px;
      border-radius: 5px;
      border: none;
      background-color: #fff;
      color: #000;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- HTML 按鈕 -->
  <div class="buttons">
    <button id="btn1"><img src="P1.png" alt="按鈕1" style="width:auto; height:auto;"></button>
    <button id="btn2"><img src="P2.png" alt="按鈕2" style="width:auto; height:auto;"></button>
  </div>

  <!-- A-Frame + MindAR 場景 -->
  <a-scene
    mindar-image="imageTargetSrc: targets.mind; autoStart: true; uiScanning: true;"
    color-space="sRGB"
    renderer="colorManagement: true; physicallyCorrectLights: true"
    vr-mode-ui="enabled: false"
    device-orientation-permission-ui="enabled: false"
  >
    <a-assets>
      <video id="introVid" src="video.mp4" preload="auto" loop muted></video>
      <img id="popup1-img" src="1-1.jpg" />
      <img id="popup2-img" src="2-1.jpg" />
    </a-assets>

    <a-light type="ambient" intensity="1.5"></a-light>
    <a-camera look-controls="enabled: false"></a-camera>

    <!-- 掃描圖卡後顯示內容 -->
    <a-entity mindar-image-target="targetIndex: 0">
      <!-- 影片播放 -->
      <a-video
        id="videoEntity"
        src="#introVid"
        width="0.7" height="1.2"
        autoplay="false"
        loop="true"
        material="shader: flat"
        position="0 0 0.01">
      </a-video>

      <!-- 圖片切換顯示 -->
      <a-image id="popup1" src="#popup1-img" position="0 0 0.02" width="1.5" height="1" visible="false"></a-image>
      <a-image id="popup2" src="#popup2-img" position="0 0 0.02" width="1.5" height="1" visible="false"></a-image>
    </a-entity>
  </a-scene>

  <script>
    window.onload = () => {
      // 取得元素
      const video = document.querySelector('#introVid');
      const videoPlane = document.querySelector('#videoEntity');
      const targetEntity = document.querySelector('a-entity[mindar-image-target]');
      const popup1 = document.querySelector("#popup1");
      const popup2 = document.querySelector("#popup2");
      const btn1 = document.querySelector("#btn1");
      const btn2 = document.querySelector("#btn2");

      // 點擊影片切換播放與暫停
      videoPlane.addEventListener('click', () => {
        if (video.paused) {
          video.play();
        } else {
          video.pause();
        }
      });

      // 掃描到圖卡，自動播放影片
      targetEntity.addEventListener('targetFound', () => {
        video.play();
      });

      // 圖卡消失，暫停並重設影片
      targetEntity.addEventListener('targetLost', () => {
        video.pause();
        video.currentTime = 0;
        // 若有圖也關閉
        popup1.setAttribute("visible", false);
        popup2.setAttribute("visible", false);
      });

      // 點擊按鈕切換圖示
      btn1.addEventListener("click", () => {
        const isVisible = popup1.getAttribute("visible");
        popup1.setAttribute("visible", !isVisible);
        if (!isVisible) popup2.setAttribute("visible", false);
      });

      btn2.addEventListener("click", () => {
        const isVisible = popup2.getAttribute("visible");
        popup2.setAttribute("visible", !isVisible);
        if (!isVisible) popup1.setAttribute("visible", false);
      });
    };
  </script>
</body>
</html>
